!function(){"use strict";function o(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function r(o,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function e(o,e,i){return e&&r(o.prototype,e),i&&r(o,i),o}(self.webpackChunkjiru_webapp=self.webpackChunkjiru_webapp||[]).push([[235],{23235:function(r,i,t){t.r(i),t.d(i,{ProyectoModule:function(){return P}});var n=t(12057),a=t(23738),c=t(37911),s=t(95859),u=t(77919),l=t(60793),d=t(23419);function f(o,r){if(1&o&&(l.TgZ(0,"div",18),l.TgZ(1,"alert",19),l._UZ(2,"i",20),l._uU(3),l.qZA(),l.qZA()),2&o){var e=r.$implicit;l.xp6(1),l.Q6J("type",e.tipo)("dismissible",e.cerrable),l.xp6(2),l.Oqu(e.mensaje)}}function p(o,r){1&o&&(l.TgZ(0,"div",21),l._uU(1," Ingresa un nombre v\xe1lido "),l.qZA())}var g,m=((g=function(){function r(e,i,t){o(this,r),this.route=e,this.router=i,this._proyectoService=t,this.esEdicion=!1,this.formProyecto=new a.cw({nombre:new a.NI("",a.kI.required)}),this.alertas=[]}return e(r,[{key:"ngOnDestroy",value:function(){this.subscripcion&&this.subscripcion.unsubscribe(),this.subscripcionCrear&&this.subscripcionCrear.unsubscribe()}},{key:"ngOnInit",value:function(){var o=this.route.snapshot.paramMap.get("id");o&&(this.esEdicion=!0,this.obtenerProyecto(o))}},{key:"obtenerProyecto",value:function(o){var r=this;this.subscripcion=this._proyectoService.obtenerProyectoPorId(o).pipe().subscribe(function(o){r.proyecto=o.resultado,r.formProyecto.setValue({nombre:r.proyecto.nombre})})}},{key:"enviarForm",value:function(){var o=this;if(this.resetAlertas(),this.formProyecto.valid){var r,e=this.formProyecto.value;r=this.esEdicion?this._proyectoService.editarProyecto(this.proyecto.id.toString(),e):this._proyectoService.crearProyecto(e),this.subscripcionCrear=r.subscribe(function(r){r.exito&&(201===r.codigoEstado||200===r.codigoEstado)&&(o.esEdicion||o.formProyecto.reset(),o.generarAlerta(r.mensaje,"exito"))},function(r){o.generarAlerta(r.error&&r.error.Mensaje?r.error.Mensaje:"Ha ocurrido un error inesperado","error")})}else this.generarAlerta("Por favor, revisa los campos ingresados","error")}},{key:"resetForm",value:function(){this.esEdicion||this.formProyecto.reset(),this.resetAlertas()}},{key:"cancelarForm",value:function(){this.router.navigate(["/proyecto/listado"])}},{key:"resetAlertas",value:function(){this.alertas=[]}},{key:"generarAlerta",value:function(o,r){this.alertas.push("error"===r?{mensaje:o,cerrable:!0,tipo:"danger"}:{mensaje:o,cerrable:!0,tipo:"success"})}}]),r}()).\u0275fac=function(o){return new(o||g)(l.Y36(s.gz),l.Y36(s.F0),l.Y36(u.X))},g.\u0275cmp=l.Xpm({type:g,selectors:[["ng-component"]],decls:24,vars:7,consts:[[1,"animated","fadeIn"],[1,"row"],[1,"col-sm-6"],["class","font-weight-bold",4,"ngFor","ngForOf"],[1,"col-sm-6","col-lg-6"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup"],[1,"form-group"],["for","nombre"],["type","text","formControlName","nombre","id","nombre","placeholder","Ingresa el nombre del proyecto","required",""],["class","invalid-feedback",4,"ngIf"],[1,"card-footer","d-flex","flex-row","justify-content-end"],["type","submit",1,"btn","btn-md","btn-primary","mr-2",3,"disabled","click"],[1,"fa","fa-save","mr-1"],["type","reset",1,"btn","btn-md","btn-danger",3,"click"],[1,"fa","fa-remove","mr-1"],[1,"font-weight-bold"],[3,"type","dismissible"],[1,"fa","fa-exclamation-circle","mr-1"],[1,"invalid-feedback"]],template:function(o,r){1&o&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.TgZ(2,"div",2),l.YNc(3,f,4,3,"div",3),l.qZA(),l.qZA(),l.TgZ(4,"div",1),l.TgZ(5,"div",4),l.TgZ(6,"div",5),l.TgZ(7,"div",6),l.TgZ(8,"h5"),l._uU(9),l.qZA(),l.qZA(),l.TgZ(10,"div",7),l.TgZ(11,"form",8),l.TgZ(12,"div",9),l.TgZ(13,"label",10),l._uU(14,"Nombre (*)"),l.qZA(),l._UZ(15,"input",11),l.YNc(16,p,2,0,"div",12),l.qZA(),l.qZA(),l.qZA(),l.TgZ(17,"div",13),l.TgZ(18,"button",14),l.NdJ("click",function(){return r.enviarForm()}),l._UZ(19,"i",15),l._uU(20,"Guardar "),l.qZA(),l.TgZ(21,"button",16),l.NdJ("click",function(){return r.cancelarForm()}),l._UZ(22,"i",17),l._uU(23,"Cancelar "),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&o&&(l.xp6(3),l.Q6J("ngForOf",r.alertas),l.xp6(6),l.Oqu(r.esEdicion?"Modificar Proyecto":"Crear Proyecto"),l.xp6(2),l.Q6J("formGroup",r.formProyecto),l.xp6(4),l.Tol(!r.formProyecto.controls.nombre.valid&&r.formProyecto.controls.nombre.dirty?"form-control is-invalid":"form-control"),l.xp6(1),l.Q6J("ngIf",!r.formProyecto.controls.nombre.valid&&r.formProyecto.controls.nombre.dirty),l.xp6(2),l.Q6J("disabled",r.formProyecto.invalid))},directives:[n.sg,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,a.Q7,n.O5,d.wx],encapsulation:2}),g),b=t(15257),Z=t(86308),v=t(6282);function h(o,r){1&o&&(l.TgZ(0,"div",14),l._uU(1," Ingresa un rol v\xe1lido "),l.qZA())}function A(o,r){1&o&&(l.TgZ(0,"div",14),l._uU(1," Ingresa un correo electr\xf3nico v\xe1lido "),l.qZA())}var y=function(){var r=function(){function r(e,i){o(this,r),this.bsModalRef=e,this._bsModalService=i,this.formUsuario=new a.cw({correoElectronico:new a.NI("",[a.kI.required,a.kI.email]),rol:new a.NI("Desarrollador",[a.kI.required])})}return e(r,[{key:"confirmar",value:function(){if(this.formUsuario.valid){var o=this.formUsuario.value;this._bsModalService.setDismissReason(JSON.stringify({estado:"operacion-confirmada",correoElectronico:o.correoElectronico,rol:o.rol})),this.bsModalRef.hide()}}}]),r}();return r.\u0275fac=function(o){return new(o||r)(l.Y36(v.UZ),l.Y36(v.tT))},r.\u0275cmp=l.Xpm({type:r,selectors:[["app-eliminar-modal"]],decls:25,vars:10,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup"],["for","rol",1,"mt-2"],["id","rol","formControlName","rol","required",""],["class","invalid-feedback",4,"ngIf"],["for","correoElectronico",1,"mt-2"],["type","email","formControlName","correoElectronico","id","correoElectronico","placeholder","Ingresa el correo electr\xf3nico","required",""],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"invalid-feedback"]],template:function(o,r){1&o&&(l.TgZ(0,"div",0),l.TgZ(1,"h4",1),l._uU(2),l.qZA(),l.TgZ(3,"button",2),l.NdJ("click",function(){return r.bsModalRef.hide()}),l.TgZ(4,"span",3),l._uU(5,"\xd7"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"div",4),l.TgZ(7,"form",5),l.TgZ(8,"label",6),l._uU(9,"Rol (*)"),l.qZA(),l.TgZ(10,"select",7),l.TgZ(11,"option"),l._uU(12,"Desarrollador"),l.qZA(),l.TgZ(13,"option"),l._uU(14,"Tester"),l.qZA(),l.qZA(),l.YNc(15,h,2,0,"div",8),l.TgZ(16,"label",9),l._uU(17,"Correo electr\xf3nico (*)"),l.qZA(),l._UZ(18,"input",10),l.YNc(19,A,2,0,"div",8),l.qZA(),l.qZA(),l.TgZ(20,"div",11),l.TgZ(21,"button",12),l.NdJ("click",function(){return r.confirmar()}),l._uU(22),l.qZA(),l.TgZ(23,"button",13),l.NdJ("click",function(){return r.bsModalRef.hide()}),l._uU(24),l.qZA(),l.qZA()),2&o&&(l.xp6(2),l.Oqu(r.titulo),l.xp6(5),l.Q6J("formGroup",r.formUsuario),l.xp6(3),l.Tol(r.formUsuario.controls.rol.valid?"form-control":"form-control is-invalid"),l.xp6(5),l.Q6J("ngIf",!r.formUsuario.controls.rol.valid&&r.formUsuario.controls.rol.dirty),l.xp6(3),l.Tol(!r.formUsuario.controls.correoElectronico.valid&&r.formUsuario.controls.correoElectronico.dirty?"form-control is-invalid":"form-control"),l.xp6(1),l.Q6J("ngIf",!r.formUsuario.controls.correoElectronico.valid&&r.formUsuario.controls.correoElectronico.dirty),l.xp6(3),l.Oqu(r.botonEnviar),l.xp6(2),l.Oqu(r.botonCerrar))},directives:[a._Y,a.JL,a.sg,a.EJ,a.JJ,a.u,a.Q7,a.YN,a.Kr,n.O5,a.Fj],encapsulation:2}),r}(),q=t(37569),T=t(53003);function x(o,r){if(1&o&&(l.TgZ(0,"div",14),l.TgZ(1,"alert",15),l._UZ(2,"i",16),l._uU(3),l.qZA(),l.qZA()),2&o){var e=r.$implicit;l.xp6(1),l.Q6J("type",e.tipo)("dismissible",e.cerrable),l.xp6(2),l.Oqu(e.mensaje)}}function U(o,r){1&o&&(l.TgZ(0,"th",10),l._uU(1,"# De Bugs"),l.qZA())}function _(o,r){1&o&&(l.TgZ(0,"th",10),l._UZ(1,"i",17),l._uU(2,"Coste total"),l.qZA())}function I(o,r){1&o&&(l.TgZ(0,"th",10),l._UZ(1,"i",18),l._uU(2,"Duraci\xf3n total"),l.qZA())}function k(o,r){1&o&&(l.TgZ(0,"th",10),l._UZ(1,"i",19),l._uU(2,"Acciones"),l.qZA())}function O(o,r){1&o&&(l.TgZ(0,"th",10),l._UZ(1,"i",20),l._uU(2,"Usuarios"),l.qZA())}function E(o,r){if(1&o&&(l.TgZ(0,"td",10),l.TgZ(1,"span",23),l._uU(2),l.qZA(),l.qZA()),2&o){var e=l.oxw().$implicit;l.xp6(2),l.Oqu(e.cantBugs)}}function N(o,r){if(1&o&&(l.TgZ(0,"td",10),l.TgZ(1,"span",24),l._uU(2),l.qZA(),l.qZA()),2&o){var e=l.oxw().$implicit;l.xp6(2),l.hij("$",e.costo,"")}}function S(o,r){if(1&o&&(l.TgZ(0,"td",10),l.TgZ(1,"span",25),l._uU(2),l.qZA(),l.qZA()),2&o){var e=l.oxw().$implicit;l.xp6(2),l.hij("",e.duracion," hs")}}function w(o,r){if(1&o){var e=l.EpF();l.TgZ(0,"td",10),l.TgZ(1,"i",26),l.NdJ("click",function(){l.CHM(e);var o=l.oxw().$implicit;return l.oxw().editarProyecto(o)}),l.qZA(),l.TgZ(2,"i",27),l.NdJ("click",function(){l.CHM(e);var o=l.oxw().$implicit;return l.oxw().eliminarProyecto(o)}),l.qZA(),l.qZA()}}function J(o,r){if(1&o){var e=l.EpF();l.TgZ(0,"td",10),l.TgZ(1,"i",28),l.NdJ("click",function(){l.CHM(e);var o=l.oxw().$implicit;return l.oxw().abrirModalAsignacion("asignar",o)}),l.qZA(),l.TgZ(2,"i",29),l.NdJ("click",function(){l.CHM(e);var o=l.oxw().$implicit;return l.oxw().abrirModalAsignacion("desasignar",o)}),l.qZA(),l.qZA()}}function R(o,r){if(1&o&&(l.TgZ(0,"tr"),l.TgZ(1,"td",21),l.TgZ(2,"span"),l._uU(3),l.qZA(),l.qZA(),l.TgZ(4,"td",22),l.TgZ(5,"span"),l._uU(6),l.qZA(),l.qZA(),l.YNc(7,E,3,1,"td",11),l.YNc(8,N,3,1,"td",11),l.YNc(9,S,3,1,"td",11),l.YNc(10,w,3,0,"td",11),l.YNc(11,J,3,0,"td",11),l.qZA()),2&o){var e=r.$implicit,i=l.oxw();l.xp6(3),l.Oqu(e.id),l.xp6(3),l.Oqu(e.nombre),l.xp6(1),l.Q6J("ngIf",i.usuarioLogeado.rol.toUpperCase()===i.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",i.usuarioLogeado.rol.toUpperCase()===i.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",i.usuarioLogeado.rol.toUpperCase()===i.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",i.usuarioLogeado.rol.toUpperCase()===i.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",i.usuarioLogeado.rol.toUpperCase()===i.ROLES.ADMINISTRADOR)}}var M=[{path:"",data:{title:"Proyecto"},children:[{path:"crear",data:{title:"Crear"},component:m},{path:"listado",data:{title:"Listado"},component:function(){var r=function(){function r(e,i,t,n){o(this,r),this._proyectoService=e,this._modalService=i,this.router=t,this._autenticacionService=n,this.ROLES=T.K,this.alertas=[],this.usuarioLogeado=n.usuarioLogeado}return e(r,[{key:"ngOnInit",value:function(){this.obtenerProyectos()}},{key:"obtenerProyectos",value:function(){var o=this;this.subscripcionObtenerDatos=this._proyectoService.obtenerProyectos().pipe().subscribe(function(r){o.proyectos=r.resultado})}},{key:"editarProyecto",value:function(o){this.router.navigate(["/proyecto/".concat(o.id)])}},{key:"eliminarProyecto",value:function(o){var r=this,e=this._modalService.show(Z.f,{initialState:{titulo:"Eliminar proyecto ".concat(o.id),mensaje:"Est\xe1s seguro que deseas eliminar el proyecto ".concat(o.nombre,"? Esta operaci\xf3n es irreversible."),botonCerrar:"Cancelar",botonEnviar:"Eliminar"}});this.subscripcionModal=e.onHide.pipe((0,b.q)(1)).subscribe(function(e){e&&"operacion-confirmada"===e&&r.confirmarEliminacion(o)})}},{key:"abrirModalAsignacion",value:function(o,r){var e=this,i={titulo:"",botonCerrar:"Cancelar",botonEnviar:"asignar"===o?"Asignar":"Desasignar"};i.titulo="asignar"===o?"Asignar usuario a ".concat(r.nombre):"Desasignar usuario de ".concat(r.nombre);var t=this._modalService.show(y,{initialState:i});this.subscripcionModal=t.onHide.pipe((0,b.q)(1)).subscribe(function(i){var t=JSON.parse(i);if(t&&"operacion-confirmada"===t.estado){var n=null;n="asignar"===o?e._proyectoService.asignarUsuario(r.id.toString(),t.correoElectronico,t.rol):e._proyectoService.desasignarUsuario(r.id.toString(),t.correoElectronico,t.rol),e.subscripcionAsignacion=n.subscribe(function(o){o.exito&&200===o.codigoEstado&&e.generarAlerta(o.mensaje,"exito")},function(o){console.log(o),e.generarAlerta(o.error&&o.error.Mensaje?o.error.Mensaje:"Ha ocurrido un error inesperado","error")})}})}},{key:"confirmarEliminacion",value:function(o){var r=this;this.resetAlertas(),this._proyectoService.eliminarProyecto(o.id).subscribe(function(o){o.exito&&200===o.codigoEstado&&(r.obtenerProyectos(),r.generarAlerta(o.mensaje,"exito"))},function(o){r.generarAlerta(o.error&&o.error.Mensaje?o.error.Mensaje:"Ha ocurrido un error inesperado","error")})}},{key:"resetAlertas",value:function(){this.alertas=[]}},{key:"generarAlerta",value:function(o,r){this.alertas.push("error"===r?{mensaje:o,cerrable:!0,tipo:"danger"}:{mensaje:o,cerrable:!0,tipo:"success"})}},{key:"ngOnDestroy",value:function(){this.subscripcionEliminar&&this.subscripcionEliminar.unsubscribe(),this.subscripcionObtenerDatos&&this.subscripcionObtenerDatos.unsubscribe(),this.subscripcionAsignacion&&this.subscripcionAsignacion.unsubscribe(),this.subscripcionModal&&this.subscripcionModal.unsubscribe()}}]),r}();return r.\u0275fac=function(o){return new(o||r)(l.Y36(u.X),l.Y36(v.tT),l.Y36(s.F0),l.Y36(q.T))},r.\u0275cmp=l.Xpm({type:r,selectors:[["ng-component"]],decls:26,vars:7,consts:[[1,"animated","fadeIn"],[1,"row"],[1,"col-sm-12"],["class","font-weight-bold",4,"ngFor","ngForOf"],[1,"col-sm-12","col-lg-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table","table-responsive-sm","table-hover","table-outline","mb-0"],[1,"thead-light"],[1,"text-center"],["class","text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"card-footer"],[1,"font-weight-bold"],[3,"type","dismissible"],[1,"fa","fa-exclamation-circle","mr-1"],[1,"fa","fa-money","mr-1"],[1,"fa","fa-clock-o","mr-1"],[1,"fa","fa-wrench","mr-1"],[1,"fa","fa-users","mr-1"],[1,"text-center","font-xl","font-weight-bold"],[1,"font-xl"],[1,"badge","badge-info","font-xl"],[1,"badge","badge-dark","font-xl"],[1,"badge","badge-success","font-xl"],[1,"fa","fa-edit","font-xl","info","text-info","pointer","cursor-pointer",3,"click"],[1,"fa","fa-remove","mr-1","font-xl","text-danger","cursor-pointer",3,"click"],[1,"fa","fa-user-plus","font-xl","info","text-info","pointer","cursor-pointer",3,"click"],[1,"fa","fa-user-times","mr-1","font-xl","text-danger","cursor-pointer",3,"click"]],template:function(o,r){1&o&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.TgZ(2,"div",2),l.YNc(3,x,4,3,"div",3),l.qZA(),l.qZA(),l.TgZ(4,"div",1),l.TgZ(5,"div",4),l.TgZ(6,"div",5),l.TgZ(7,"div",6),l.TgZ(8,"h5"),l._uU(9,"Listado de Proyectos"),l.qZA(),l.qZA(),l.TgZ(10,"div",7),l.TgZ(11,"table",8),l.TgZ(12,"thead",9),l.TgZ(13,"tr"),l.TgZ(14,"th",10),l._uU(15,"ID"),l.qZA(),l.TgZ(16,"th"),l._uU(17,"Nombre"),l.qZA(),l.YNc(18,U,2,0,"th",11),l.YNc(19,_,3,0,"th",11),l.YNc(20,I,3,0,"th",11),l.YNc(21,k,3,0,"th",11),l.YNc(22,O,3,0,"th",11),l.qZA(),l.qZA(),l.TgZ(23,"tbody"),l.YNc(24,R,12,7,"tr",12),l.qZA(),l.qZA(),l.qZA(),l._UZ(25,"div",13),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&o&&(l.xp6(3),l.Q6J("ngForOf",r.alertas),l.xp6(15),l.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),l.xp6(1),l.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),l.xp6(2),l.Q6J("ngForOf",r.proyectos))},directives:[n.sg,n.O5,d.wx],encapsulation:2}),r}()},{path:":id",data:{title:"Modificar"},component:m}]}],C=function(){var r=function r(){o(this,r)};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=l.oAB({type:r}),r.\u0275inj=l.cJS({imports:[[s.Bz.forChild(M)],s.Bz]}),r}(),P=function(){var r=function r(){o(this,r)};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=l.oAB({type:r}),r.\u0275inj=l.cJS({imports:[[n.ez,a.UX,a.u5,C,c.Fq.forRoot(),d.nM.forRoot(),v.zk.forRoot()]]}),r}()}}])}();