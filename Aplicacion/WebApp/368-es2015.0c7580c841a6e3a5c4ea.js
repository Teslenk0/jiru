"use strict";(self.webpackChunkjiru_webapp=self.webpackChunkjiru_webapp||[]).push([[368],{53368:function(t,e,o){o.r(e),o.d(e,{ImportacionModule:function(){return U}});var i=o(12057),r=o(23738),s=o(37911),n=o(23419),a=o(6282),l=o(60793),p=o(44553),c=o(64762),d=o(93856),u=o(45424),h=o(38634);const m=["*"];let g=(()=>{class t{constructor(){this.adaptivePosition=!0,this.placement="top",this.triggers="hover focus",this.delay=0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,l.Yz7)({factory:function(){return new t},token:t,providedIn:"root"}),t})(),b=(()=>{class t{constructor(t){Object.assign(this,t)}get isBs3(){return(0,p.XA)()}ngAfterViewInit(){this.classMap={in:!1,fade:!1},this.classMap[this.placement]=!0,this.classMap[`tooltip-${this.placement}`]=!0,this.classMap.in=!0,this.animation&&(this.classMap.fade=!0),this.containerClass&&(this.classMap[this.containerClass]=!0)}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(g))},t.\u0275cmp=l.Xpm({type:t,selectors:[["bs-tooltip-container"]],hostAttrs:["role","tooltip"],hostVars:7,hostBindings:function(t,e){2&t&&(l.uIk("id",e.id),l.Tol("tooltip in tooltip-"+e.placement+" bs-tooltip-"+e.placement+" "+e.placement+" "+e.containerClass),l.ekj("show",!e.isBs3)("bs3",e.isBs3))},ngContentSelectors:m,decls:3,vars:0,consts:[[1,"tooltip-arrow","arrow"],[1,"tooltip-inner"]],template:function(t,e){1&t&&(l.F$t(),l._UZ(0,"div",0),l.TgZ(1,"div",1),l.Hsn(2),l.qZA())},styles:[".tooltip[_nghost-%COMP%] {\n      display: block;\n      pointer-events: none;\n    }\n    .bs3.tooltip.top[_nghost-%COMP%] > .arrow[_ngcontent-%COMP%] {\n      margin-left: -2px;\n    }\n    .bs3.tooltip.bottom[_nghost-%COMP%] {\n      margin-top: 0px;\n    }\n    .bs3.bs-tooltip-left[_nghost-%COMP%], .bs3.bs-tooltip-right[_nghost-%COMP%]{\n      margin: 0px;\n    }\n    .bs3.bs-tooltip-right[_nghost-%COMP%]   .arrow[_ngcontent-%COMP%], .bs3.bs-tooltip-left[_nghost-%COMP%]   .arrow[_ngcontent-%COMP%] {\n      margin: .3rem 0;\n    }"],changeDetection:0}),t})(),f=0,v=(()=>{class t{constructor(t,e,o,i,r,s){this._elementRef=i,this._renderer=r,this._positionService=s,this.tooltipId=f++,this.tooltipChange=new l.vpe,this.containerClass="",this.tooltipAnimation=!0,this.tooltipFadeDuration=150,this.tooltipStateChanged=new l.vpe,this._tooltip=e.createLoader(this._elementRef,t,this._renderer).provide({provide:g,useValue:o}),Object.assign(this,o),this.onShown=this._tooltip.onShown,this.onHidden=this._tooltip.onHidden}get isOpen(){return this._tooltip.isShown}set isOpen(t){t?this.show():this.hide()}set htmlContent(t){(0,p.O4)("tooltipHtml was deprecated, please use `tooltip` instead"),this.tooltip=t}set _placement(t){(0,p.O4)("tooltipPlacement was deprecated, please use `placement` instead"),this.placement=t}set _isOpen(t){(0,p.O4)("tooltipIsOpen was deprecated, please use `isOpen` instead"),this.isOpen=t}get _isOpen(){return(0,p.O4)("tooltipIsOpen was deprecated, please use `isOpen` instead"),this.isOpen}set _enable(t){(0,p.O4)("tooltipEnable was deprecated, please use `isDisabled` instead"),this.isDisabled=!t}get _enable(){return(0,p.O4)("tooltipEnable was deprecated, please use `isDisabled` instead"),this.isDisabled}set _appendToBody(t){(0,p.O4)('tooltipAppendToBody was deprecated, please use `container="body"` instead'),this.container=t?"body":this.container}get _appendToBody(){return(0,p.O4)('tooltipAppendToBody was deprecated, please use `container="body"` instead'),"body"===this.container}set _popupClass(t){(0,p.O4)("tooltipClass deprecated")}set _tooltipContext(t){(0,p.O4)("tooltipContext deprecated")}set _tooltipPopupDelay(t){(0,p.O4)("tooltipPopupDelay is deprecated, use `delay` instead"),this.delay=t}get _tooltipTrigger(){return(0,p.O4)("tooltipTrigger was deprecated, please use `triggers` instead"),this.triggers}set _tooltipTrigger(t){(0,p.O4)("tooltipTrigger was deprecated, please use `triggers` instead"),this.triggers=(t||"").toString()}ngOnInit(){this._tooltip.listen({triggers:this.triggers,show:()=>this.show()}),this.tooltipChange.subscribe(t=>{t||this._tooltip.hide()}),this.onShown.subscribe(()=>{this.setAriaDescribedBy()}),this.onHidden.subscribe(()=>{this.setAriaDescribedBy()})}setAriaDescribedBy(){this._ariaDescribedby=this.isOpen?`tooltip-${this.tooltipId}`:null,this._ariaDescribedby?this._renderer.setAttribute(this._elementRef.nativeElement,"aria-describedby",this._ariaDescribedby):this._renderer.removeAttribute(this._elementRef.nativeElement,"aria-describedby")}toggle(){if(this.isOpen)return this.hide();this.show()}show(){if(this._positionService.setOptions({modifiers:{flip:{enabled:this.adaptivePosition},preventOverflow:{enabled:this.adaptivePosition}}}),this.isOpen||this.isDisabled||this._delayTimeoutId||!this.tooltip)return;const t=()=>{this._delayTimeoutId&&(this._delayTimeoutId=void 0),this._tooltip.attach(b).to(this.container).position({attachment:this.placement}).show({content:this.tooltip,placement:this.placement,containerClass:this.containerClass,id:`tooltip-${this.tooltipId}`})},e=()=>{this._tooltipCancelShowFn&&this._tooltipCancelShowFn()};this.delay?(this._delaySubscription&&this._delaySubscription.unsubscribe(),this._delaySubscription=(0,h.H)(this.delay).subscribe(()=>{t(),e()}),this.triggers&&(0,p.AL)(this.triggers).forEach(t=>{this._tooltipCancelShowFn=this._renderer.listen(this._elementRef.nativeElement,t.close,()=>{this._delaySubscription.unsubscribe(),e()})})):t()}hide(){this._delayTimeoutId&&(clearTimeout(this._delayTimeoutId),this._delayTimeoutId=void 0),this._tooltip.isShown&&(this._tooltip.instance.classMap.in=!1,setTimeout(()=>{this._tooltip.hide()},this.tooltipFadeDuration))}ngOnDestroy(){this._tooltip.dispose(),this.tooltipChange.unsubscribe(),this._delaySubscription&&this._delaySubscription.unsubscribe(),this.onShown.unsubscribe(),this.onHidden.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(l.s_b),l.Y36(d.oj),l.Y36(g),l.Y36(l.SBq),l.Y36(l.Qsj),l.Y36(u.sA))},t.\u0275dir=l.lG2({type:t,selectors:[["","tooltip",""],["","tooltipHtml",""]],inputs:{containerClass:"containerClass",tooltipAnimation:"tooltipAnimation",tooltipFadeDuration:"tooltipFadeDuration",isOpen:"isOpen",htmlContent:["tooltipHtml","htmlContent"],tooltip:"tooltip",_placement:["tooltipPlacement","_placement"],placement:"placement",_isOpen:["tooltipIsOpen","_isOpen"],_enable:["tooltipEnable","_enable"],isDisabled:"isDisabled",_appendToBody:["tooltipAppendToBody","_appendToBody"],container:"container",_popupClass:["tooltipClass","_popupClass"],_tooltipContext:["tooltipContext","_tooltipContext"],_tooltipPopupDelay:["tooltipPopupDelay","_tooltipPopupDelay"],delay:"delay",_tooltipTrigger:["tooltipTrigger","_tooltipTrigger"],triggers:"triggers",adaptivePosition:"adaptivePosition"},outputs:{tooltipChange:"tooltipChange",tooltipStateChanged:"tooltipStateChanged",onShown:"onShown",onHidden:"onHidden"},exportAs:["bs-tooltip"]}),(0,c.gn)([(0,p.GU)(),(0,c.w6)("design:type",Object)],t.prototype,"tooltip",void 0),t})(),_=(()=>{class t{static forRoot(){return{ngModule:t,providers:[d.oj,u.sA]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.ez]]}),t})();var y=o(95859),Z=o(88002),A=o(92340),O=o(58497);let w=(()=>{class t{constructor(t){this._httpClient=t,this.obtenerImportadoresDisponibles=()=>this._httpClient.get(`${this.apiUrl}/importacion/disponible`).pipe((0,Z.U)(t=>t)),this.importarBugs=t=>this._httpClient.post(`${this.apiUrl}/importacion`,t).pipe((0,Z.U)(t=>t)),this.apiUrl=A.N.apiUrl}}return t.\u0275fac=function(e){return new(e||t)(l.LFG(O.eN))},t.\u0275prov=l.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function C(t,e){if(1&t&&(l.TgZ(0,"div",25),l.TgZ(1,"alert",26),l._UZ(2,"i",27),l._uU(3),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.xp6(1),l.Q6J("type",t.tipo)("dismissible",t.cerrable),l.xp6(2),l.Oqu(t.mensaje)}}function T(t,e){if(1&t&&(l.TgZ(0,"option"),l._uU(1),l.qZA()),2&t){const t=e.$implicit;l.xp6(1),l.Oqu(t.nombre)}}function I(t,e){1&t&&(l.TgZ(0,"div",28),l._uU(1," Selecciona un proveedor v\xe1lido "),l.qZA())}function q(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"div"),l.TgZ(1,"div",29),l.TgZ(2,"div",30),l.TgZ(3,"div",31),l._UZ(4,"input",32),l.qZA(),l.TgZ(5,"div",33),l._UZ(6,"input",34),l.qZA(),l.TgZ(7,"div",35),l.TgZ(8,"i",36),l.NdJ("click",function(e){const o=l.CHM(t).index;return l.oxw().quitarParametro(e,o)}),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&t){const t=e.index;l.xp6(2),l.Q6J("formGroupName",t),l.xp6(2),l.Q6J("id","clave-parametro-"+t),l.xp6(2),l.Q6J("id","valor-parametro-"+t)}}const x=[{path:"",data:{title:"Importacion"},children:[{path:"bug",data:{title:"Bug"},component:(()=>{class t{constructor(t,e,o,i){this.formBuilder=t,this.router=e,this.route=o,this._importacionService=i,this.formImportacion=this.formBuilder.group({proveedor:["default",[r.kI.required]],correoUsuarioResuelve:["",[r.kI.required,r.kI.email]],parametros:this.formBuilder.array([this.formBuilder.group({clave:["",[]],valor:["",[]]})])}),this.alertas=[]}ngOnInit(){this.obtenerImportadores()}ngOnDestroy(){this.subscripcionImportar&&this.subscripcionImportar.unsubscribe(),this.subscripcionForm&&this.subscripcionForm.unsubscribe(),this.subscripcionObtenerImportadores&&this.subscripcionObtenerImportadores.unsubscribe()}get parametros(){return this.formImportacion.get("parametros")}obtenerImportadores(){this.subscripcionObtenerImportadores=this._importacionService.obtenerImportadoresDisponibles().pipe().subscribe(t=>{this.importadores=t.resultado})}agregarParametro(t){t.preventDefault(),this.parametros.push(this.formBuilder.group({clave:["",[]],valor:["",[]]}))}quitarParametro(t,e){t.preventDefault(),this.parametros.removeAt(e)}enviarForm(){if(this.resetAlertas(),this.formImportacion.valid){const t=this.formImportacion.value,e={};t.parametros.forEach(t=>e[t.clave.replace(" ","_")]=t.valor),t.parametros=Object.assign(Object.assign({},e),{correoUsuarioResuelve:t.correoUsuarioResuelve}),this.subscripcionImportar=this._importacionService.importarBugs(t).subscribe(t=>{t.exito&&(201===t.codigoEstado||200===t.codigoEstado)&&(this.resetForm(!1),this.generarAlerta(t.mensaje,"exito"))},t=>{this.generarAlerta(t.error&&t.error.Mensaje?t.error.Mensaje:"Ha ocurrido un error inesperado","error")})}else this.generarAlerta("Por favor, revisa los campos ingresados","error")}resetForm(t=!0){this.formImportacion.reset(),this.formImportacion.controls.proveedor.setValue("default"),t&&this.resetAlertas()}cancelarForm(){this.router.navigate(["/bug/listado"])}resetAlertas(){this.alertas=[]}generarAlerta(t,e){this.alertas.push("error"===e?{mensaje:t,cerrable:!0,tipo:"danger"}:{mensaje:t,cerrable:!0,tipo:"success"})}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(r.qu),l.Y36(y.F0),l.Y36(y.gz),l.Y36(w))},t.\u0275cmp=l.Xpm({type:t,selectors:[["ng-component"]],decls:36,vars:8,consts:[[1,"animated","fadeIn"],[1,"row"],[1,"col-sm-6"],["class","font-weight-bold",4,"ngFor","ngForOf"],[1,"col-sm-6","col-lg-6"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup"],["for","proveedor",1,"mt-2"],["id","proveedor","formControlName","proveedor","required",""],["value","default"],[4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["for","correoUsuarioResuelve",1,"mt-2"],["tooltip","Este correo electr\xf3nico se necesita para los bugs que est\xe1n marcados como resueltos en el archivo a importar, as\xed se puede calcular el costo.",1,"text-primary","fa","fa-question-circle-o","mr-1"],["type","text","formControlName","correoUsuarioResuelve","id","correoUsuarioResuelve","placeholder","Ingresa el correo del desarrollador","required","",1,"form-control"],["for","parametros",1,"mt-2","d-flex","justify-content-between"],["tooltip","Agregar nuevo par\xe1metro que desees enviar al importador. Los espacios en las claves ser\xe1n convertidos a '_'",1,"fa","fa-plus","font-xl","text-primary","cursor-pointer",3,"click"],["formArrayName","parametros"],[1,"card-footer","d-flex","flex-row","justify-content-end"],["type","submit",1,"btn","btn-md","btn-primary","mr-2",3,"disabled","click"],[1,"fa","fa-save","mr-1"],["type","reset",1,"btn","btn-md","btn-danger",3,"click"],[1,"fa","fa-remove","mr-1"],[1,"font-weight-bold"],[3,"type","dismissible"],[1,"fa","fa-exclamation-circle","mr-1"],[1,"invalid-feedback"],[1,"d-flex","flex-column","mt-2"],[1,"row",3,"formGroupName"],[1,"col-md-5"],["type","text","formControlName","clave","placeholder","Clave",1,"form-control",3,"id"],[1,"col-md-6"],["type","text","formControlName","valor","placeholder","Valor",1,"form-control",3,"id"],[1,"col-md-1","d-flex","justify-content-center","align-items-center"],["tooltip","Quitar par\xe1metro",1,"fa","fa-remove","font-xl","text-danger","cursor-pointer",3,"click"]],template:function(t,e){1&t&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.TgZ(2,"div",2),l.YNc(3,C,4,3,"div",3),l.qZA(),l.qZA(),l.TgZ(4,"div",1),l.TgZ(5,"div",4),l.TgZ(6,"div",5),l.TgZ(7,"div",6),l.TgZ(8,"h5"),l._uU(9,"Importar Bugs"),l.qZA(),l.qZA(),l.TgZ(10,"div",7),l.TgZ(11,"form",8),l.TgZ(12,"label",9),l._uU(13,"Proveedor (*)"),l.qZA(),l.TgZ(14,"select",10),l.TgZ(15,"option",11),l._uU(16,"Selecciona un proveedor"),l.qZA(),l.YNc(17,T,2,1,"option",12),l.qZA(),l.YNc(18,I,2,0,"div",13),l.TgZ(19,"label",14),l._UZ(20,"i",15),l._uU(21," Correo del Desarrollador (*) "),l.qZA(),l._UZ(22,"input",16),l.TgZ(23,"div"),l.TgZ(24,"label",17),l._uU(25," Par\xe1metros "),l.TgZ(26,"i",18),l.NdJ("click",function(t){return e.agregarParametro(t)}),l.qZA(),l.qZA(),l.TgZ(27,"div",19),l.YNc(28,q,9,3,"div",12),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(29,"div",20),l.TgZ(30,"button",21),l.NdJ("click",function(){return e.enviarForm()}),l._UZ(31,"i",22),l._uU(32,"Guardar "),l.qZA(),l.TgZ(33,"button",23),l.NdJ("click",function(){return e.cancelarForm()}),l._UZ(34,"i",24),l._uU(35,"Cancelar "),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&t&&(l.xp6(3),l.Q6J("ngForOf",e.alertas),l.xp6(8),l.Q6J("formGroup",e.formImportacion),l.xp6(3),l.Tol(e.formImportacion.controls.proveedor.valid?"form-control":"form-control is-invalid"),l.xp6(3),l.Q6J("ngForOf",e.importadores),l.xp6(1),l.Q6J("ngIf",!e.formImportacion.controls.proveedor.valid&&e.formImportacion.controls.proveedor.dirty),l.xp6(10),l.Q6J("ngForOf",e.parametros.controls),l.xp6(2),l.Q6J("disabled",e.formImportacion.invalid))},directives:[i.sg,r._Y,r.JL,r.sg,r.EJ,r.JJ,r.u,r.Q7,r.YN,r.Kr,i.O5,v,r.Fj,r.CE,n.wx,r.x0],encapsulation:2}),t})()}]}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[y.Bz.forChild(x)],y.Bz]}),t})(),U=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.ez,r.UX,r.u5,S,s.Fq.forRoot(),n.nM.forRoot(),a.zk.forRoot(),r.UX,_]]}),t})()}}]);