"use strict";(self.webpackChunkjiru_webapp=self.webpackChunkjiru_webapp||[]).push([[235],{23235:function(o,r,e){e.r(r),e.d(r,{ProyectoModule:function(){return M}});var i=e(12057),t=e(23738),n=e(37911),s=e(95859),c=e(77919),a=e(60793),l=e(23419);function u(o,r){if(1&o&&(a.TgZ(0,"div",18),a.TgZ(1,"alert",19),a._UZ(2,"i",20),a._uU(3),a.qZA(),a.qZA()),2&o){const o=r.$implicit;a.xp6(1),a.Q6J("type",o.tipo)("dismissible",o.cerrable),a.xp6(2),a.Oqu(o.mensaje)}}function d(o,r){1&o&&(a.TgZ(0,"div",21),a._uU(1," Ingresa un nombre v\xe1lido "),a.qZA())}let p=(()=>{class o{constructor(o,r,e){this.route=o,this.router=r,this._proyectoService=e,this.esEdicion=!1,this.formProyecto=new t.cw({nombre:new t.NI("",t.kI.required)}),this.alertas=[]}ngOnDestroy(){this.subscripcion&&this.subscripcion.unsubscribe(),this.subscripcionCrear&&this.subscripcionCrear.unsubscribe()}ngOnInit(){const o=this.route.snapshot.paramMap.get("id");o&&(this.esEdicion=!0,this.obtenerProyecto(o))}obtenerProyecto(o){this.subscripcion=this._proyectoService.obtenerProyectoPorId(o).pipe().subscribe(o=>{this.proyecto=o.resultado,this.formProyecto.setValue({nombre:this.proyecto.nombre})})}enviarForm(){if(this.resetAlertas(),this.formProyecto.valid){const o=this.formProyecto.value;let r;r=this.esEdicion?this._proyectoService.editarProyecto(this.proyecto.id.toString(),o):this._proyectoService.crearProyecto(o),this.subscripcionCrear=r.subscribe(o=>{o.exito&&(201===o.codigoEstado||200===o.codigoEstado)&&(this.esEdicion||this.formProyecto.reset(),this.generarAlerta(o.mensaje,"exito"))},o=>{this.generarAlerta(o.error&&o.error.Mensaje?o.error.Mensaje:"Ha ocurrido un error inesperado","error")})}else this.generarAlerta("Por favor, revisa los campos ingresados","error")}resetForm(){this.esEdicion||this.formProyecto.reset(),this.resetAlertas()}cancelarForm(){this.router.navigate(["/proyecto/listado"])}resetAlertas(){this.alertas=[]}generarAlerta(o,r){this.alertas.push("error"===r?{mensaje:o,cerrable:!0,tipo:"danger"}:{mensaje:o,cerrable:!0,tipo:"success"})}}return o.\u0275fac=function(r){return new(r||o)(a.Y36(s.gz),a.Y36(s.F0),a.Y36(c.X))},o.\u0275cmp=a.Xpm({type:o,selectors:[["ng-component"]],decls:24,vars:7,consts:[[1,"animated","fadeIn"],[1,"row"],[1,"col-sm-6"],["class","font-weight-bold",4,"ngFor","ngForOf"],[1,"col-sm-6","col-lg-6"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup"],[1,"form-group"],["for","nombre"],["type","text","formControlName","nombre","id","nombre","placeholder","Ingresa el nombre del proyecto","required",""],["class","invalid-feedback",4,"ngIf"],[1,"card-footer","d-flex","flex-row","justify-content-end"],["type","submit",1,"btn","btn-md","btn-primary","mr-2",3,"disabled","click"],[1,"fa","fa-save","mr-1"],["type","reset",1,"btn","btn-md","btn-danger",3,"click"],[1,"fa","fa-remove","mr-1"],[1,"font-weight-bold"],[3,"type","dismissible"],[1,"fa","fa-exclamation-circle","mr-1"],[1,"invalid-feedback"]],template:function(o,r){1&o&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.YNc(3,u,4,3,"div",3),a.qZA(),a.qZA(),a.TgZ(4,"div",1),a.TgZ(5,"div",4),a.TgZ(6,"div",5),a.TgZ(7,"div",6),a.TgZ(8,"h5"),a._uU(9),a.qZA(),a.qZA(),a.TgZ(10,"div",7),a.TgZ(11,"form",8),a.TgZ(12,"div",9),a.TgZ(13,"label",10),a._uU(14,"Nombre (*)"),a.qZA(),a._UZ(15,"input",11),a.YNc(16,d,2,0,"div",12),a.qZA(),a.qZA(),a.qZA(),a.TgZ(17,"div",13),a.TgZ(18,"button",14),a.NdJ("click",function(){return r.enviarForm()}),a._UZ(19,"i",15),a._uU(20,"Guardar "),a.qZA(),a.TgZ(21,"button",16),a.NdJ("click",function(){return r.cancelarForm()}),a._UZ(22,"i",17),a._uU(23,"Cancelar "),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&o&&(a.xp6(3),a.Q6J("ngForOf",r.alertas),a.xp6(6),a.Oqu(r.esEdicion?"Modificar Proyecto":"Crear Proyecto"),a.xp6(2),a.Q6J("formGroup",r.formProyecto),a.xp6(4),a.Tol(!r.formProyecto.controls.nombre.valid&&r.formProyecto.controls.nombre.dirty?"form-control is-invalid":"form-control"),a.xp6(1),a.Q6J("ngIf",!r.formProyecto.controls.nombre.valid&&r.formProyecto.controls.nombre.dirty),a.xp6(2),a.Q6J("disabled",r.formProyecto.invalid))},directives:[i.sg,t._Y,t.JL,t.sg,t.Fj,t.JJ,t.u,t.Q7,i.O5,l.wx],encapsulation:2}),o})();var f=e(15257),g=e(86308),m=e(6282);function Z(o,r){1&o&&(a.TgZ(0,"div",14),a._uU(1," Ingresa un rol v\xe1lido "),a.qZA())}function b(o,r){1&o&&(a.TgZ(0,"div",14),a._uU(1," Ingresa un correo electr\xf3nico v\xe1lido "),a.qZA())}let h=(()=>{class o{constructor(o,r){this.bsModalRef=o,this._bsModalService=r,this.formUsuario=new t.cw({correoElectronico:new t.NI("",[t.kI.required,t.kI.email]),rol:new t.NI("Desarrollador",[t.kI.required])})}confirmar(){if(this.formUsuario.valid){const o=this.formUsuario.value;this._bsModalService.setDismissReason(JSON.stringify({estado:"operacion-confirmada",correoElectronico:o.correoElectronico,rol:o.rol})),this.bsModalRef.hide()}}}return o.\u0275fac=function(r){return new(r||o)(a.Y36(m.UZ),a.Y36(m.tT))},o.\u0275cmp=a.Xpm({type:o,selectors:[["app-eliminar-modal"]],decls:25,vars:10,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"formGroup"],["for","rol",1,"mt-2"],["id","rol","formControlName","rol","required",""],["class","invalid-feedback",4,"ngIf"],["for","correoElectronico",1,"mt-2"],["type","email","formControlName","correoElectronico","id","correoElectronico","placeholder","Ingresa el correo electr\xf3nico","required",""],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"invalid-feedback"]],template:function(o,r){1&o&&(a.TgZ(0,"div",0),a.TgZ(1,"h4",1),a._uU(2),a.qZA(),a.TgZ(3,"button",2),a.NdJ("click",function(){return r.bsModalRef.hide()}),a.TgZ(4,"span",3),a._uU(5,"\xd7"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(6,"div",4),a.TgZ(7,"form",5),a.TgZ(8,"label",6),a._uU(9,"Rol (*)"),a.qZA(),a.TgZ(10,"select",7),a.TgZ(11,"option"),a._uU(12,"Desarrollador"),a.qZA(),a.TgZ(13,"option"),a._uU(14,"Tester"),a.qZA(),a.qZA(),a.YNc(15,Z,2,0,"div",8),a.TgZ(16,"label",9),a._uU(17,"Correo electr\xf3nico (*)"),a.qZA(),a._UZ(18,"input",10),a.YNc(19,b,2,0,"div",8),a.qZA(),a.qZA(),a.TgZ(20,"div",11),a.TgZ(21,"button",12),a.NdJ("click",function(){return r.confirmar()}),a._uU(22),a.qZA(),a.TgZ(23,"button",13),a.NdJ("click",function(){return r.bsModalRef.hide()}),a._uU(24),a.qZA(),a.qZA()),2&o&&(a.xp6(2),a.Oqu(r.titulo),a.xp6(5),a.Q6J("formGroup",r.formUsuario),a.xp6(3),a.Tol(r.formUsuario.controls.rol.valid?"form-control":"form-control is-invalid"),a.xp6(5),a.Q6J("ngIf",!r.formUsuario.controls.rol.valid&&r.formUsuario.controls.rol.dirty),a.xp6(3),a.Tol(!r.formUsuario.controls.correoElectronico.valid&&r.formUsuario.controls.correoElectronico.dirty?"form-control is-invalid":"form-control"),a.xp6(1),a.Q6J("ngIf",!r.formUsuario.controls.correoElectronico.valid&&r.formUsuario.controls.correoElectronico.dirty),a.xp6(3),a.Oqu(r.botonEnviar),a.xp6(2),a.Oqu(r.botonCerrar))},directives:[t._Y,t.JL,t.sg,t.EJ,t.JJ,t.u,t.Q7,t.YN,t.Kr,i.O5,t.Fj],encapsulation:2}),o})();var A=e(37569),v=e(53003);function q(o,r){if(1&o&&(a.TgZ(0,"div",14),a.TgZ(1,"alert",15),a._UZ(2,"i",16),a._uU(3),a.qZA(),a.qZA()),2&o){const o=r.$implicit;a.xp6(1),a.Q6J("type",o.tipo)("dismissible",o.cerrable),a.xp6(2),a.Oqu(o.mensaje)}}function T(o,r){1&o&&(a.TgZ(0,"th",10),a._uU(1,"# De Bugs"),a.qZA())}function y(o,r){1&o&&(a.TgZ(0,"th",10),a._UZ(1,"i",17),a._uU(2,"Coste total"),a.qZA())}function x(o,r){1&o&&(a.TgZ(0,"th",10),a._UZ(1,"i",18),a._uU(2,"Duraci\xf3n total"),a.qZA())}function U(o,r){1&o&&(a.TgZ(0,"th",10),a._UZ(1,"i",19),a._uU(2,"Acciones"),a.qZA())}function _(o,r){1&o&&(a.TgZ(0,"th",10),a._UZ(1,"i",20),a._uU(2,"Usuarios"),a.qZA())}function I(o,r){if(1&o&&(a.TgZ(0,"td",10),a.TgZ(1,"span",23),a._uU(2),a.qZA(),a.qZA()),2&o){const o=a.oxw().$implicit;a.xp6(2),a.Oqu(o.cantBugs)}}function O(o,r){if(1&o&&(a.TgZ(0,"td",10),a.TgZ(1,"span",24),a._uU(2),a.qZA(),a.qZA()),2&o){const o=a.oxw().$implicit;a.xp6(2),a.hij("$",o.costo,"")}}function E(o,r){if(1&o&&(a.TgZ(0,"td",10),a.TgZ(1,"span",25),a._uU(2),a.qZA(),a.qZA()),2&o){const o=a.oxw().$implicit;a.xp6(2),a.hij("",o.duracion," hs")}}function N(o,r){if(1&o){const o=a.EpF();a.TgZ(0,"td",10),a.TgZ(1,"i",26),a.NdJ("click",function(){a.CHM(o);const r=a.oxw().$implicit;return a.oxw().editarProyecto(r)}),a.qZA(),a.TgZ(2,"i",27),a.NdJ("click",function(){a.CHM(o);const r=a.oxw().$implicit;return a.oxw().eliminarProyecto(r)}),a.qZA(),a.qZA()}}function S(o,r){if(1&o){const o=a.EpF();a.TgZ(0,"td",10),a.TgZ(1,"i",28),a.NdJ("click",function(){a.CHM(o);const r=a.oxw().$implicit;return a.oxw().abrirModalAsignacion("asignar",r)}),a.qZA(),a.TgZ(2,"i",29),a.NdJ("click",function(){a.CHM(o);const r=a.oxw().$implicit;return a.oxw().abrirModalAsignacion("desasignar",r)}),a.qZA(),a.qZA()}}function w(o,r){if(1&o&&(a.TgZ(0,"tr"),a.TgZ(1,"td",21),a.TgZ(2,"span"),a._uU(3),a.qZA(),a.qZA(),a.TgZ(4,"td",22),a.TgZ(5,"span"),a._uU(6),a.qZA(),a.qZA(),a.YNc(7,I,3,1,"td",11),a.YNc(8,O,3,1,"td",11),a.YNc(9,E,3,1,"td",11),a.YNc(10,N,3,0,"td",11),a.YNc(11,S,3,0,"td",11),a.qZA()),2&o){const o=r.$implicit,e=a.oxw();a.xp6(3),a.Oqu(o.id),a.xp6(3),a.Oqu(o.nombre),a.xp6(1),a.Q6J("ngIf",e.usuarioLogeado.rol.toUpperCase()===e.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",e.usuarioLogeado.rol.toUpperCase()===e.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",e.usuarioLogeado.rol.toUpperCase()===e.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",e.usuarioLogeado.rol.toUpperCase()===e.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",e.usuarioLogeado.rol.toUpperCase()===e.ROLES.ADMINISTRADOR)}}const J=[{path:"",data:{title:"Proyecto"},children:[{path:"crear",data:{title:"Crear"},component:p},{path:"listado",data:{title:"Listado"},component:(()=>{class o{constructor(o,r,e,i){this._proyectoService=o,this._modalService=r,this.router=e,this._autenticacionService=i,this.ROLES=v.K,this.alertas=[],this.usuarioLogeado=i.usuarioLogeado}ngOnInit(){this.obtenerProyectos()}obtenerProyectos(){this.subscripcionObtenerDatos=this._proyectoService.obtenerProyectos().pipe().subscribe(o=>{this.proyectos=o.resultado})}editarProyecto(o){this.router.navigate([`/proyecto/${o.id}`])}eliminarProyecto(o){const r=this._modalService.show(g.f,{initialState:{titulo:`Eliminar proyecto ${o.id}`,mensaje:`Est\xe1s seguro que deseas eliminar el proyecto ${o.nombre}? Esta operaci\xf3n es irreversible.`,botonCerrar:"Cancelar",botonEnviar:"Eliminar"}});this.subscripcionModal=r.onHide.pipe((0,f.q)(1)).subscribe(r=>{r&&"operacion-confirmada"===r&&this.confirmarEliminacion(o)})}abrirModalAsignacion(o,r){const e={titulo:"",botonCerrar:"Cancelar",botonEnviar:"asignar"===o?"Asignar":"Desasignar"};e.titulo="asignar"===o?`Asignar usuario a ${r.nombre}`:`Desasignar usuario de ${r.nombre}`;const i=this._modalService.show(h,{initialState:e});this.subscripcionModal=i.onHide.pipe((0,f.q)(1)).subscribe(e=>{const i=JSON.parse(e);if(i&&"operacion-confirmada"===i.estado){let e=null;e="asignar"===o?this._proyectoService.asignarUsuario(r.id.toString(),i.correoElectronico,i.rol):this._proyectoService.desasignarUsuario(r.id.toString(),i.correoElectronico,i.rol),this.subscripcionAsignacion=e.subscribe(o=>{o.exito&&200===o.codigoEstado&&this.generarAlerta(o.mensaje,"exito")},o=>{console.log(o),this.generarAlerta(o.error&&o.error.Mensaje?o.error.Mensaje:"Ha ocurrido un error inesperado","error")})}})}confirmarEliminacion(o){this.resetAlertas(),this._proyectoService.eliminarProyecto(o.id).subscribe(o=>{o.exito&&200===o.codigoEstado&&(this.obtenerProyectos(),this.generarAlerta(o.mensaje,"exito"))},o=>{this.generarAlerta(o.error&&o.error.Mensaje?o.error.Mensaje:"Ha ocurrido un error inesperado","error")})}resetAlertas(){this.alertas=[]}generarAlerta(o,r){this.alertas.push("error"===r?{mensaje:o,cerrable:!0,tipo:"danger"}:{mensaje:o,cerrable:!0,tipo:"success"})}ngOnDestroy(){this.subscripcionEliminar&&this.subscripcionEliminar.unsubscribe(),this.subscripcionObtenerDatos&&this.subscripcionObtenerDatos.unsubscribe(),this.subscripcionAsignacion&&this.subscripcionAsignacion.unsubscribe(),this.subscripcionModal&&this.subscripcionModal.unsubscribe()}}return o.\u0275fac=function(r){return new(r||o)(a.Y36(c.X),a.Y36(m.tT),a.Y36(s.F0),a.Y36(A.T))},o.\u0275cmp=a.Xpm({type:o,selectors:[["ng-component"]],decls:26,vars:7,consts:[[1,"animated","fadeIn"],[1,"row"],[1,"col-sm-12"],["class","font-weight-bold",4,"ngFor","ngForOf"],[1,"col-sm-12","col-lg-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table","table-responsive-sm","table-hover","table-outline","mb-0"],[1,"thead-light"],[1,"text-center"],["class","text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"card-footer"],[1,"font-weight-bold"],[3,"type","dismissible"],[1,"fa","fa-exclamation-circle","mr-1"],[1,"fa","fa-money","mr-1"],[1,"fa","fa-clock-o","mr-1"],[1,"fa","fa-wrench","mr-1"],[1,"fa","fa-users","mr-1"],[1,"text-center","font-xl","font-weight-bold"],[1,"font-xl"],[1,"badge","badge-info","font-xl"],[1,"badge","badge-dark","font-xl"],[1,"badge","badge-success","font-xl"],[1,"fa","fa-edit","font-xl","info","text-info","pointer","cursor-pointer",3,"click"],[1,"fa","fa-remove","mr-1","font-xl","text-danger","cursor-pointer",3,"click"],[1,"fa","fa-user-plus","font-xl","info","text-info","pointer","cursor-pointer",3,"click"],[1,"fa","fa-user-times","mr-1","font-xl","text-danger","cursor-pointer",3,"click"]],template:function(o,r){1&o&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.YNc(3,q,4,3,"div",3),a.qZA(),a.qZA(),a.TgZ(4,"div",1),a.TgZ(5,"div",4),a.TgZ(6,"div",5),a.TgZ(7,"div",6),a.TgZ(8,"h5"),a._uU(9,"Listado de Proyectos"),a.qZA(),a.qZA(),a.TgZ(10,"div",7),a.TgZ(11,"table",8),a.TgZ(12,"thead",9),a.TgZ(13,"tr"),a.TgZ(14,"th",10),a._uU(15,"ID"),a.qZA(),a.TgZ(16,"th"),a._uU(17,"Nombre"),a.qZA(),a.YNc(18,T,2,0,"th",11),a.YNc(19,y,3,0,"th",11),a.YNc(20,x,3,0,"th",11),a.YNc(21,U,3,0,"th",11),a.YNc(22,_,3,0,"th",11),a.qZA(),a.qZA(),a.TgZ(23,"tbody"),a.YNc(24,w,12,7,"tr",12),a.qZA(),a.qZA(),a.qZA(),a._UZ(25,"div",13),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&o&&(a.xp6(3),a.Q6J("ngForOf",r.alertas),a.xp6(15),a.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),a.xp6(1),a.Q6J("ngIf",r.usuarioLogeado.rol.toUpperCase()===r.ROLES.ADMINISTRADOR),a.xp6(2),a.Q6J("ngForOf",r.proyectos))},directives:[i.sg,i.O5,l.wx],encapsulation:2}),o})()},{path:":id",data:{title:"Modificar"},component:p}]}];let R=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=a.oAB({type:o}),o.\u0275inj=a.cJS({imports:[[s.Bz.forChild(J)],s.Bz]}),o})(),M=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=a.oAB({type:o}),o.\u0275inj=a.cJS({imports:[[i.ez,t.UX,t.u5,R,n.Fq.forRoot(),l.nM.forRoot(),m.zk.forRoot()]]}),o})()}}]);